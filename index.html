<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
   
    <!-- Meta Data -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Title -->
    <title>Mudra Leaderboard</title>

    <!-- Favicon -->
    <link rel="shortcut icon" type="image/icon" href="assets/images/bg.jpg"/>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Poppins:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Rufina:400,700" rel="stylesheet">

    <!-- CSS Files -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/bootsnav.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
    <link rel="stylesheet" href="styles.css"> <!-- Custom CSS -->

    <!-- Chart.js for Graph -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <!-- Header Section -->
    <section id="home" class="welcome-hero">
        <div class="top-area">
            <div class="header-area">
                <nav class="navbar navbar-default bootsnav navbar-sticky navbar-scrollspy" data-minus-value-desktop="70" data-minus-value-mobile="55" data-speed="1000">
                    <div class="container">
                        <div class="navbar-header">
                           <a class="navbar-brand" href="index.html" style="
                            padding: 45px;
                        "> Mudra 2025</a>
                        </div>
                        <div class="collapse navbar-collapse menu-ui-design" id="navbar-menu">
                            <ul class="nav navbar-nav navbar-right" data-in="fadeInDown" data-out="fadeOutUp"></ul>
                        </div>
                    </div>
                </nav>
            </div>
        </div>
    </section>

    <!-- Leaderboard Section -->
    <section id="leaderboard" class="leaderboard-container">
        <h2 class="section-title">Leaderboard</h2>
        <div class="leaderboard">
            <table>
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th class="Department">Department</th>
                        <th class="matches">Scores</th>
                    </tr>
                </thead>
                <tbody id="leaderboard-body">
                    <!-- Dynamic data will be inserted here -->
                </tbody>
            </table>
        </div>

        <!-- Leaderboard Graph -->
    <!-- Leaderboard Chart -->
    <div class="chart-container">
    <canvas id="leaderboardChart"></canvas>
</div>

    </section>

    <!-- Footer -->
    <footer>
        &copy; 2025 Professional League â€¢ Last updated: March 16, 2025
    </footer>

    <!-- JavaScript -->
    <script>
    const sheetURL = "https://script.google.com/macros/s/AKfycbznHaikscZwtyJiAGJSruTVqJ8-tQJo-iVcF8QkkDOL_2Uru01yHvkLSVyqIjQrmdI/exec"; 
    let leaderboardChart; // Global variable for the chart

    async function fetchScores() {
        try {
            let response = await fetch(sheetURL);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            let data = await response.json();

            // Sort by Scores in descending order
            data.sort((a, b) => b.Scores - a.Scores);

            // Update leaderboard and chart
            updateLeaderboard(data);
            updateChart(data);
        } catch (error) {
            console.error("Error fetching scores:", error);
        }
    }

    function updateLeaderboard(data) {
        const leaderboardBody = document.getElementById('leaderboard-body');
        leaderboardBody.innerHTML = ''; // Clear existing rows
        data.forEach((team, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${index + 1}</td>
                <td class="Department">${team.Department || 'N/A'}</td>
                <td class="matches">${team.Scores || 0}</td>
            `;
            leaderboardBody.appendChild(row);
        });
    }

    function updateChart(data) {
        const ctx = document.getElementById('leaderboardChart').getContext('2d');

        // If a previous chart exists, destroy it to avoid duplication
        if (leaderboardChart) {
            leaderboardChart.destroy();
        }

        // Extract labels and scores
        let labels = data.map(team => team.Department);
        let scores = data.map(team => team.Scores);

        leaderboardChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: "Scores",
                    data: scores,
                    backgroundColor: [
                        '#FFD700', '#C0C0C0', '#CD7F32', '#4E89AE', '#A23E48', 
                        '#FF5733', '#33FF57', '#5733FF', '#FF33A8', '#33FFF9'
                    ],
                    borderColor: "rgba(255, 255, 255, 0.8)",
                    borderWidth: 2,
                    borderRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: "#222",
                        titleColor: "#FFD700",
                        bodyColor: "#fff"
                    }
                },
                scales: {
                    x: {
                        grid: { display: false },
                        ticks: {
                            color: "#FFD700",
                            font: { size: 14 }
                        }
                    },
                    y: {
                        grid: { color: "rgba(255, 255, 255, 0.2)" },
                        ticks: {
                            color: "#fff",
                            font: { size: 14 }
                        }
                    }
                }
            }
        });
    }

    // Fetch scores and update every 10 seconds
    fetchScores();
    setInterval(fetchScores, 10000);
</script>

</body>
</html>
